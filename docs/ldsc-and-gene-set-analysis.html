<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 8 LDSC and Gene-Set Analysis | CSHL course - GWAS Hands-on Analysis</title>
  <meta name="description" content="This is the course material for the CSHL hands-on session in GWAS and eQTL." />
  <meta name="generator" content="bookdown 0.41 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 8 LDSC and Gene-Set Analysis | CSHL course - GWAS Hands-on Analysis" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This is the course material for the CSHL hands-on session in GWAS and eQTL." />
  <meta name="github-repo" content="rstudio/cshl_gwas" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 8 LDSC and Gene-Set Analysis | CSHL course - GWAS Hands-on Analysis" />
  
  <meta name="twitter:description" content="This is the course material for the CSHL hands-on session in GWAS and eQTL." />
  

<meta name="author" content="Min Zhang, Danni Liu- University of California, Irvine; Purdue University" />


<meta name="date" content="2025-06-09" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="gxg-and-gxe-interactions-power-and-sample-size-calculation.html"/>
<link rel="next" href="perform-eqtl-analysis.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">CSHL Course- GWAS and EQTL Hands-on Analysis</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Welcome to the GWAS and eQTL Workshop</a>
<ul>
<li class="chapter" data-level="1.0.1" data-path="index.html"><a href="index.html#overview"><i class="fa fa-check"></i><b>1.0.1</b> Overview</a></li>
<li class="chapter" data-level="1.0.2" data-path="index.html"><a href="index.html#folder-structure"><i class="fa fa-check"></i><b>1.0.2</b> Folder structure:</a></li>
<li class="chapter" data-level="1.0.3" data-path="index.html"><a href="index.html#programming-languages"><i class="fa fa-check"></i><b>1.0.3</b> Programming Languages:</a></li>
<li class="chapter" data-level="1.0.4" data-path="index.html"><a href="index.html#required-gwas-tools"><i class="fa fa-check"></i><b>1.0.4</b> Required GWAS Tools</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="an-overview-of-regression-with-toy-examples.html"><a href="an-overview-of-regression-with-toy-examples.html"><i class="fa fa-check"></i><b>2</b> An Overview of Regression with Toy Examples</a>
<ul>
<li class="chapter" data-level="2.1" data-path="an-overview-of-regression-with-toy-examples.html"><a href="an-overview-of-regression-with-toy-examples.html#environment-setting-and-packages"><i class="fa fa-check"></i><b>2.1</b> Environment Setting and Packages</a></li>
<li class="chapter" data-level="2.2" data-path="an-overview-of-regression-with-toy-examples.html"><a href="an-overview-of-regression-with-toy-examples.html#toy-example-data"><i class="fa fa-check"></i><b>2.2</b> Toy Example Data</a></li>
<li class="chapter" data-level="2.3" data-path="an-overview-of-regression-with-toy-examples.html"><a href="an-overview-of-regression-with-toy-examples.html#logistic-regression"><i class="fa fa-check"></i><b>2.3</b> Logistic Regression</a></li>
<li class="chapter" data-level="2.4" data-path="an-overview-of-regression-with-toy-examples.html"><a href="an-overview-of-regression-with-toy-examples.html#roc-curve-and-auc-for-hoxb13"><i class="fa fa-check"></i><b>2.4</b> ROC curve and AUC for HOXB13</a></li>
<li class="chapter" data-level="2.5" data-path="an-overview-of-regression-with-toy-examples.html"><a href="an-overview-of-regression-with-toy-examples.html#practice"><i class="fa fa-check"></i><b>2.5</b> Practice</a></li>
<li class="chapter" data-level="2.6" data-path="an-overview-of-regression-with-toy-examples.html"><a href="an-overview-of-regression-with-toy-examples.html#comparison-of-hoxb13-roc-curve-and-nhlh1-roc-curve"><i class="fa fa-check"></i><b>2.6</b> Comparison of HOXB13 ROC curve and NHLH1 ROC curve</a></li>
<li class="chapter" data-level="2.7" data-path="an-overview-of-regression-with-toy-examples.html"><a href="an-overview-of-regression-with-toy-examples.html#linear-regression"><i class="fa fa-check"></i><b>2.7</b> Linear Regression</a>
<ul>
<li class="chapter" data-level="2.7.1" data-path="an-overview-of-regression-with-toy-examples.html"><a href="an-overview-of-regression-with-toy-examples.html#linear-regression-of-hoxb13-vs.-il17br"><i class="fa fa-check"></i><b>2.7.1</b> Linear regression of HOXB13 vs. IL17BR</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="an-overview-of-regression-with-toy-examples.html"><a href="an-overview-of-regression-with-toy-examples.html#variable-selectionforward-backward-and-stepwise-selection"><i class="fa fa-check"></i><b>2.8</b> Variable selection–Forward, backward and stepwise selection</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="gwas-tools-and-data-preprocessing-workflow-with-toy-example.html"><a href="gwas-tools-and-data-preprocessing-workflow-with-toy-example.html"><i class="fa fa-check"></i><b>3</b> GWAS Tools and Data Preprocessing Workflow with Toy Example</a>
<ul>
<li class="chapter" data-level="3.1" data-path="gwas-tools-and-data-preprocessing-workflow-with-toy-example.html"><a href="gwas-tools-and-data-preprocessing-workflow-with-toy-example.html#environment-setting"><i class="fa fa-check"></i><b>3.1</b> Environment Setting</a></li>
<li class="chapter" data-level="3.2" data-path="gwas-tools-and-data-preprocessing-workflow-with-toy-example.html"><a href="gwas-tools-and-data-preprocessing-workflow-with-toy-example.html#gwas-tools"><i class="fa fa-check"></i><b>3.2</b> GWAS Tools</a></li>
<li class="chapter" data-level="3.3" data-path="gwas-tools-and-data-preprocessing-workflow-with-toy-example.html"><a href="gwas-tools-and-data-preprocessing-workflow-with-toy-example.html#quality-control"><i class="fa fa-check"></i><b>3.3</b> Quality Control</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="gwas-tools-and-data-preprocessing-workflow-with-toy-example.html"><a href="gwas-tools-and-data-preprocessing-workflow-with-toy-example.html#an-example-of-summary-statistics"><i class="fa fa-check"></i><b>3.3.1</b> An Example of Summary Statistics</a></li>
<li class="chapter" data-level="3.3.2" data-path="gwas-tools-and-data-preprocessing-workflow-with-toy-example.html"><a href="gwas-tools-and-data-preprocessing-workflow-with-toy-example.html#an-example-of-inclusion-thresholds-for-qc"><i class="fa fa-check"></i><b>3.3.2</b> An Example of Inclusion Thresholds for QC</a></li>
<li class="chapter" data-level="3.3.3" data-path="gwas-tools-and-data-preprocessing-workflow-with-toy-example.html"><a href="gwas-tools-and-data-preprocessing-workflow-with-toy-example.html#remove-closely-related-individuals"><i class="fa fa-check"></i><b>3.3.3</b> Remove Closely Related Individuals</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="gwas-tools-and-data-preprocessing-workflow-with-toy-example.html"><a href="gwas-tools-and-data-preprocessing-workflow-with-toy-example.html#an-imputation-example"><i class="fa fa-check"></i><b>3.4</b> An Imputation Example</a></li>
<li class="chapter" data-level="3.5" data-path="gwas-tools-and-data-preprocessing-workflow-with-toy-example.html"><a href="gwas-tools-and-data-preprocessing-workflow-with-toy-example.html#population-stratification-correction-using-plink"><i class="fa fa-check"></i><b>3.5</b> Population Stratification Correction Using PLINK</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="gwas-tools-and-data-preprocessing-workflow-with-toy-example.html"><a href="gwas-tools-and-data-preprocessing-workflow-with-toy-example.html#pca-on-whole-genome-data-using-plink"><i class="fa fa-check"></i><b>3.5.1</b> PCA on whole genome data using PLINK</a></li>
<li class="chapter" data-level="3.5.2" data-path="gwas-tools-and-data-preprocessing-workflow-with-toy-example.html"><a href="gwas-tools-and-data-preprocessing-workflow-with-toy-example.html#test-the-significance-of-principle-components-pcs"><i class="fa fa-check"></i><b>3.5.2</b> Test the Significance of Principle Components (PCs)</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="gwas-tools-and-data-preprocessing-workflow-with-toy-example.html"><a href="gwas-tools-and-data-preprocessing-workflow-with-toy-example.html#simple-association-test"><i class="fa fa-check"></i><b>3.6</b> Simple Association Test</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="gwas-tools-and-data-preprocessing-workflow-with-toy-example.html"><a href="gwas-tools-and-data-preprocessing-workflow-with-toy-example.html#quantitative-trait-association-test-for-continuous-trait"><i class="fa fa-check"></i><b>3.6.1</b> Quantitative Trait Association Test for Continuous Trait</a></li>
<li class="chapter" data-level="3.6.2" data-path="gwas-tools-and-data-preprocessing-workflow-with-toy-example.html"><a href="gwas-tools-and-data-preprocessing-workflow-with-toy-example.html#casecontrol-asssociation-test-for-binary-trait"><i class="fa fa-check"></i><b>3.6.2</b> Case/Control Asssociation Test for Binary Trait</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="gwas-tools-and-data-preprocessing-workflow-with-toy-example.html"><a href="gwas-tools-and-data-preprocessing-workflow-with-toy-example.html#quantitative-trait-association-test-for-continuous-trait-with-covariates"><i class="fa fa-check"></i><b>3.7</b> Quantitative Trait Association Test for Continuous Trait with Covariates</a>
<ul>
<li class="chapter" data-level="3.7.1" data-path="gwas-tools-and-data-preprocessing-workflow-with-toy-example.html"><a href="gwas-tools-and-data-preprocessing-workflow-with-toy-example.html#covariates-adjustments-using-r"><i class="fa fa-check"></i><b>3.7.1</b> Covariates adjustments (using R):</a></li>
<li class="chapter" data-level="3.7.2" data-path="gwas-tools-and-data-preprocessing-workflow-with-toy-example.html"><a href="gwas-tools-and-data-preprocessing-workflow-with-toy-example.html#association-test-using-plink"><i class="fa fa-check"></i><b>3.7.2</b> Association test using plink</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="gwas-case-study-data-preparation.html"><a href="gwas-case-study-data-preparation.html"><i class="fa fa-check"></i><b>4</b> GWAS Case Study-Data Preparation</a>
<ul>
<li class="chapter" data-level="4.1" data-path="gwas-case-study-data-preparation.html"><a href="gwas-case-study-data-preparation.html#environment-setting-and-packages-1"><i class="fa fa-check"></i><b>4.1</b> Environment setting and packages</a></li>
<li class="chapter" data-level="4.2" data-path="gwas-case-study-data-preparation.html"><a href="gwas-case-study-data-preparation.html#accessing-data"><i class="fa fa-check"></i><b>4.2</b> Accessing data</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="gwas-case-study-data-preparation.html"><a href="gwas-case-study-data-preparation.html#data-availability"><i class="fa fa-check"></i><b>4.2.1</b> Data availability</a></li>
<li class="chapter" data-level="4.2.2" data-path="gwas-case-study-data-preparation.html"><a href="gwas-case-study-data-preparation.html#data-files-documentation"><i class="fa fa-check"></i><b>4.2.2</b> Data files documentation</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="gwas-case-study-data-preparation.html"><a href="gwas-case-study-data-preparation.html#preprocessing-phenotype-data"><i class="fa fa-check"></i><b>4.3</b> Preprocessing Phenotype Data</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="gwas-case-study-data-preparation.html"><a href="gwas-case-study-data-preparation.html#extracting-phenotype-data"><i class="fa fa-check"></i><b>4.3.1</b> Extracting phenotype data</a></li>
<li class="chapter" data-level="4.3.2" data-path="gwas-case-study-data-preparation.html"><a href="gwas-case-study-data-preparation.html#summary-of-phenotypes-data"><i class="fa fa-check"></i><b>4.3.2</b> Summary of Phenotypes Data</a></li>
<li class="chapter" data-level="4.3.3" data-path="gwas-case-study-data-preparation.html"><a href="gwas-case-study-data-preparation.html#histogram-of-each-trait"><i class="fa fa-check"></i><b>4.3.3</b> Histogram of each trait</a></li>
<li class="chapter" data-level="4.3.4" data-path="gwas-case-study-data-preparation.html"><a href="gwas-case-study-data-preparation.html#handling-the-missing-values-in-the-phenotypes-and-covariates"><i class="fa fa-check"></i><b>4.3.4</b> Handling the missing values in the phenotypes and covariates</a></li>
<li class="chapter" data-level="4.3.5" data-path="gwas-case-study-data-preparation.html"><a href="gwas-case-study-data-preparation.html#checking-normality-assumptions-for-each-trait"><i class="fa fa-check"></i><b>4.3.5</b> Checking normality assumptions for each trait</a></li>
<li class="chapter" data-level="4.3.6" data-path="gwas-case-study-data-preparation.html"><a href="gwas-case-study-data-preparation.html#normalize-phenotype-data"><i class="fa fa-check"></i><b>4.3.6</b> Normalize phenotype data</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="gwas-case-study-data-preparation.html"><a href="gwas-case-study-data-preparation.html#covariates-adjustment"><i class="fa fa-check"></i><b>4.4</b> Covariates Adjustment</a></li>
<li class="chapter" data-level="4.5" data-path="gwas-case-study-data-preparation.html"><a href="gwas-case-study-data-preparation.html#prepare-plink-data"><i class="fa fa-check"></i><b>4.5</b> Prepare PLINK data</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="gwas-case-study-data-preparation.html"><a href="gwas-case-study-data-preparation.html#step-1-prepare-plink-ped-file"><i class="fa fa-check"></i><b>4.5.1</b> Step 1: prepare PLINK ped file</a></li>
<li class="chapter" data-level="4.5.2" data-path="gwas-case-study-data-preparation.html"><a href="gwas-case-study-data-preparation.html#step-2-prepare-plink-map-file"><i class="fa fa-check"></i><b>4.5.2</b> Step 2: prepare PLINK map file</a></li>
<li class="chapter" data-level="4.5.3" data-path="gwas-case-study-data-preparation.html"><a href="gwas-case-study-data-preparation.html#step-3-prepare-plink-alternate-phenotype-file-in-linux"><i class="fa fa-check"></i><b>4.5.3</b> Step 3 : prepare PLINK alternate phenotype file (in Linux)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="gwas-with-continuous-trait.html"><a href="gwas-with-continuous-trait.html"><i class="fa fa-check"></i><b>5</b> GWAS with Continuous Trait</a>
<ul>
<li class="chapter" data-level="5.1" data-path="gwas-with-continuous-trait.html"><a href="gwas-with-continuous-trait.html#manhattan-plot-and-q-q-plot"><i class="fa fa-check"></i><b>5.1</b> Manhattan Plot and Q-Q Plot</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="gwas-with-continuous-trait.html"><a href="gwas-with-continuous-trait.html#generate-manhattan-plot"><i class="fa fa-check"></i><b>5.1.1</b> Generate manhattan plot</a></li>
<li class="chapter" data-level="5.1.2" data-path="gwas-with-continuous-trait.html"><a href="gwas-with-continuous-trait.html#generate-q-q-plot"><i class="fa fa-check"></i><b>5.1.2</b> Generate Q-Q plot</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="gwas-with-continuous-trait.html"><a href="gwas-with-continuous-trait.html#multiple-test-correction"><i class="fa fa-check"></i><b>5.2</b> Multiple-Test Correction</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="gwas-with-continuous-trait.html"><a href="gwas-with-continuous-trait.html#prepare-r-input-files-in-linux"><i class="fa fa-check"></i><b>5.2.1</b> Prepare R input files (in Linux)</a></li>
<li class="chapter" data-level="5.2.2" data-path="gwas-with-continuous-trait.html"><a href="gwas-with-continuous-trait.html#significant-snps-after-a-multiple-test-correction-of-fdr-using-r"><i class="fa fa-check"></i><b>5.2.2</b> Significant SNPs after a multiple-test correction of FDR (using R)</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="gwas-with-continuous-trait.html"><a href="gwas-with-continuous-trait.html#regional-association-plot"><i class="fa fa-check"></i><b>5.3</b> Regional Association Plot</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="gwas-with-continuous-trait.html"><a href="gwas-with-continuous-trait.html#obtain-regional-snps-using-r"><i class="fa fa-check"></i><b>5.3.1</b> Obtain regional SNPs (using R)</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="gwas-with-continuous-trait.html"><a href="gwas-with-continuous-trait.html#distribution-of-z-endoxifen-ratio-for-rs8138080"><i class="fa fa-check"></i><b>5.4</b> Distribution of Z-endoxifen ratio for rs8138080</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="gwas-with-continuous-trait.html"><a href="gwas-with-continuous-trait.html#obtain-phenotype-data-z-endoxifen-ratio-using-r"><i class="fa fa-check"></i><b>5.4.1</b> Obtain phenotype data (Z-endoxifen ratio) (using R)</a></li>
<li class="chapter" data-level="5.4.2" data-path="gwas-with-continuous-trait.html"><a href="gwas-with-continuous-trait.html#obtain-genotype-for-significant-snps-using-r"><i class="fa fa-check"></i><b>5.4.2</b> Obtain genotype for significant SNPs (using R)</a></li>
<li class="chapter" data-level="5.4.3" data-path="gwas-with-continuous-trait.html"><a href="gwas-with-continuous-trait.html#create-box-plot-using-r"><i class="fa fa-check"></i><b>5.4.3</b> Create Box plot (using R)</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="gwas-with-continuous-trait.html"><a href="gwas-with-continuous-trait.html#proportion-of-variation-explained-by-rs8138080"><i class="fa fa-check"></i><b>5.5</b> Proportion of Variation Explained by rs8138080</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="gwas-with-continuous-trait.html"><a href="gwas-with-continuous-trait.html#recode-genotype-of-significant-snps-using-r"><i class="fa fa-check"></i><b>5.5.1</b> Recode genotype of significant SNPs (using R)</a></li>
<li class="chapter" data-level="5.5.2" data-path="gwas-with-continuous-trait.html"><a href="gwas-with-continuous-trait.html#calculate-marginal-r2-using-r"><i class="fa fa-check"></i><b>5.5.2</b> Calculate marginal <span class="math inline">\(R^2\)</span> (using R)</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="gwas-with-continuous-trait.html"><a href="gwas-with-continuous-trait.html#practice-time"><i class="fa fa-check"></i><b>5.6</b> PRACTICE TIME</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="gwas-with-continuous-trait.html"><a href="gwas-with-continuous-trait.html#practice-1"><i class="fa fa-check"></i><b>5.6.1</b> Practice 1</a></li>
<li class="chapter" data-level="5.6.2" data-path="gwas-with-continuous-trait.html"><a href="gwas-with-continuous-trait.html#practice-2"><i class="fa fa-check"></i><b>5.6.2</b> Practice 2</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="gwas-with-binary-trait.html"><a href="gwas-with-binary-trait.html"><i class="fa fa-check"></i><b>6</b> GWAS with Binary Trait</a>
<ul>
<li class="chapter" data-level="6.1" data-path="gwas-with-binary-trait.html"><a href="gwas-with-binary-trait.html#data-preparation"><i class="fa fa-check"></i><b>6.1</b> Data Preparation</a></li>
<li class="chapter" data-level="6.2" data-path="gwas-with-binary-trait.html"><a href="gwas-with-binary-trait.html#genome-wide-casecontrol-association-test-in-plink"><i class="fa fa-check"></i><b>6.2</b> Genome-Wide Case/Control Association Test (in PLINK)</a></li>
<li class="chapter" data-level="6.3" data-path="gwas-with-binary-trait.html"><a href="gwas-with-binary-trait.html#manhattan-plot-and-q-q-plot-1"><i class="fa fa-check"></i><b>6.3</b> Manhattan Plot and Q-Q Plot</a></li>
<li class="chapter" data-level="6.4" data-path="gwas-with-binary-trait.html"><a href="gwas-with-binary-trait.html#generate-manhattan-plot-1"><i class="fa fa-check"></i><b>6.4</b> Generate Manhattan plot</a></li>
<li class="chapter" data-level="6.5" data-path="gwas-with-binary-trait.html"><a href="gwas-with-binary-trait.html#generate-q-q-plot-1"><i class="fa fa-check"></i><b>6.5</b> Generate Q-Q plot</a></li>
<li class="chapter" data-level="6.6" data-path="gwas-with-binary-trait.html"><a href="gwas-with-binary-trait.html#multiple-test-correction-1"><i class="fa fa-check"></i><b>6.6</b> Multiple-Test Correction</a></li>
<li class="chapter" data-level="6.7" data-path="gwas-with-binary-trait.html"><a href="gwas-with-binary-trait.html#top-10-snps"><i class="fa fa-check"></i><b>6.7</b> Top 10 SNPs</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="gxg-and-gxe-interactions-power-and-sample-size-calculation.html"><a href="gxg-and-gxe-interactions-power-and-sample-size-calculation.html"><i class="fa fa-check"></i><b>7</b> GxG and GxE Interactions, Power and Sample Size Calculation</a>
<ul>
<li class="chapter" data-level="7.1" data-path="gxg-and-gxe-interactions-power-and-sample-size-calculation.html"><a href="gxg-and-gxe-interactions-power-and-sample-size-calculation.html#prepare-files"><i class="fa fa-check"></i><b>7.1</b> Prepare Files</a></li>
<li class="chapter" data-level="7.2" data-path="gxg-and-gxe-interactions-power-and-sample-size-calculation.html"><a href="gxg-and-gxe-interactions-power-and-sample-size-calculation.html#test-for-epistasis-gxg"><i class="fa fa-check"></i><b>7.2</b> Test for Epistasis (GxG)</a></li>
<li class="chapter" data-level="7.3" data-path="gxg-and-gxe-interactions-power-and-sample-size-calculation.html"><a href="gxg-and-gxe-interactions-power-and-sample-size-calculation.html#gene-environment-interaction-gxe"><i class="fa fa-check"></i><b>7.3</b> Gene-Environment Interaction (GxE)</a></li>
<li class="chapter" data-level="7.4" data-path="gxg-and-gxe-interactions-power-and-sample-size-calculation.html"><a href="gxg-and-gxe-interactions-power-and-sample-size-calculation.html#power-and-sample-size-calculation-for-gwas"><i class="fa fa-check"></i><b>7.4</b> Power and sample size calculation for GWAS</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="gxg-and-gxe-interactions-power-and-sample-size-calculation.html"><a href="gxg-and-gxe-interactions-power-and-sample-size-calculation.html#power-calculation-with-binary-outcome"><i class="fa fa-check"></i><b>7.4.1</b> Power calculation with binary outcome:</a></li>
<li class="chapter" data-level="7.4.2" data-path="gxg-and-gxe-interactions-power-and-sample-size-calculation.html"><a href="gxg-and-gxe-interactions-power-and-sample-size-calculation.html#sample-size-calculation"><i class="fa fa-check"></i><b>7.4.2</b> Sample size calculation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="ldsc-and-gene-set-analysis.html"><a href="ldsc-and-gene-set-analysis.html"><i class="fa fa-check"></i><b>8</b> LDSC and Gene-Set Analysis</a>
<ul>
<li class="chapter" data-level="8.1" data-path="ldsc-and-gene-set-analysis.html"><a href="ldsc-and-gene-set-analysis.html#ldsc-linkage-disequilibrium-score-regression"><i class="fa fa-check"></i><b>8.1</b> LDSC (Linkage Disequilibrium Score Regression)</a></li>
<li class="chapter" data-level="8.2" data-path="ldsc-and-gene-set-analysis.html"><a href="ldsc-and-gene-set-analysis.html#magma-for-gene-level-analysis"><i class="fa fa-check"></i><b>8.2</b> MAGMA (for Gene-Level Analysis)</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="ldsc-and-gene-set-analysis.html"><a href="ldsc-and-gene-set-analysis.html#prepare-annotation-file"><i class="fa fa-check"></i><b>8.2.1</b> Prepare Annotation File</a></li>
<li class="chapter" data-level="8.2.2" data-path="ldsc-and-gene-set-analysis.html"><a href="ldsc-and-gene-set-analysis.html#part-1-gene-analysis"><i class="fa fa-check"></i><b>8.2.2</b> Part 1: Gene Analysis</a></li>
<li class="chapter" data-level="8.2.3" data-path="ldsc-and-gene-set-analysis.html"><a href="ldsc-and-gene-set-analysis.html#part-2-gene-set-analysis"><i class="fa fa-check"></i><b>8.2.3</b> Part 2: Gene-Set Analysis</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="perform-eqtl-analysis.html"><a href="perform-eqtl-analysis.html"><i class="fa fa-check"></i><b>9</b> Perform eQTL Analysis</a>
<ul>
<li class="chapter" data-level="9.1" data-path="perform-eqtl-analysis.html"><a href="perform-eqtl-analysis.html#filtering-snps-by-maf"><i class="fa fa-check"></i><b>9.1</b> Filtering SNPs by MAF</a></li>
<li class="chapter" data-level="9.2" data-path="perform-eqtl-analysis.html"><a href="perform-eqtl-analysis.html#gene-expression-profiling"><i class="fa fa-check"></i><b>9.2</b> Gene expression profiling</a></li>
<li class="chapter" data-level="9.3" data-path="perform-eqtl-analysis.html"><a href="perform-eqtl-analysis.html#covariates"><i class="fa fa-check"></i><b>9.3</b> Covariates</a></li>
<li class="chapter" data-level="9.4" data-path="perform-eqtl-analysis.html"><a href="perform-eqtl-analysis.html#using-principle-components-as-covariates"><i class="fa fa-check"></i><b>9.4</b> Using principle components as covariates</a></li>
<li class="chapter" data-level="9.5" data-path="perform-eqtl-analysis.html"><a href="perform-eqtl-analysis.html#eqtl-analysis"><i class="fa fa-check"></i><b>9.5</b> eQTL analysis</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="perform-eqtl-analysis.html"><a href="perform-eqtl-analysis.html#cis-eqtl-and-trans-eqtl-analysis"><i class="fa fa-check"></i><b>9.5.1</b> cis-eQTL and trans-eQTL analysis</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="perform-eqtl-analysis.html"><a href="perform-eqtl-analysis.html#multiple-testing-correction"><i class="fa fa-check"></i><b>9.6</b> Multiple testing correction</a></li>
<li class="chapter" data-level="9.7" data-path="perform-eqtl-analysis.html"><a href="perform-eqtl-analysis.html#gene-regional-manhanttan-plots"><i class="fa fa-check"></i><b>9.7</b> Gene regional Manhanttan plots</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">CSHL course - GWAS Hands-on Analysis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="ldsc-and-gene-set-analysis" class="section level1 hasAnchor" number="8">
<h1><span class="header-section-number">Chapter 8</span> LDSC and Gene-Set Analysis<a href="ldsc-and-gene-set-analysis.html#ldsc-and-gene-set-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Due to privacy concern, there haven’t been many individual genotype datasets that are publically available online. So finding and preparing a genotype data for GWAS analysis can cost great efforts in research. Here are several analysis tools that are able to directly handle GWAS summary statistics and perform post-GWAS analysis.</p>
<div id="ldsc-linkage-disequilibrium-score-regression" class="section level2 hasAnchor" number="8.1">
<h2><span class="header-section-number">8.1</span> LDSC (Linkage Disequilibrium Score Regression)<a href="ldsc-and-gene-set-analysis.html#ldsc-linkage-disequilibrium-score-regression" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>LDSC is a popular tool to use when you only have the public results from GWAS analysis. LDSC aims to quantify the polygenic effects, such as population stratification, using regression analysis. Please check the original paper from <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4495769/">Bulik-Sullivan et al.(2015)</a>.</p>
<p>It has to be installed in command line and requires Anaconda python dstribution. We won’t practice this software here since the installation may depend on computer system. But you can try the examples on their website if your laptop satisfies the system requirements.</p>
<p><a href="https://github.com/bulik/ldsc">LDSC Github page</a> contains installation instructions. They also provide detailed examples on how to {estimate LD scores](<a href="https://github.com/bulik/ldsc/wiki/LD-Score-Estimation-Tutorial" class="uri">https://github.com/bulik/ldsc/wiki/LD-Score-Estimation-Tutorial</a>), <a href="https://github.com/bulik/ldsc/wiki/Heritability-and-Genetic-Correlation">estimate SNP heritability and genetic correlation among phenotypes</a> and <a href="https://github.com/bulik/ldsc/wiki/Partitioned-Heritability">partition the heritability into categories</a> using GWAS summary statistics.</p>
<p>Below are two public courses that gives a good introduction to LDSC:</p>
<p><a href="https://www.youtube.com/watch?v=dVrF0l9jMgE">Video 1: LD Score Regression I, Heritability and Partitioning</a></p>
<p><a href="https://www.youtube.com/watch?v=QVPNouAbXsY">Video 2: LD Score Regression II, Heritability and Partitioning</a></p>
</div>
<div id="magma-for-gene-level-analysis" class="section level2 hasAnchor" number="8.2">
<h2><span class="header-section-number">8.2</span> MAGMA (for Gene-Level Analysis)<a href="ldsc-and-gene-set-analysis.html#magma-for-gene-level-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>MAGMA is a statistical methods for gene-set analysis of multiple genetic markers. This method can be used when the individual marker’s effects are too weak to be detected, such as in polygenic traits. It aims to analyze multiple markers simultaneously to estimate their joint effects. Please check the paper from <a href="https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1004219">de Leewu et al.(2015)</a>.</p>
<p>The analysis consists of two parts. The first part is gene analysis, which combines all SNPs within a gene region and examines the overall association between each gene and phenotype using a multiple linear regression model. This step requires the raw genotype data if not already have the GWAS results. The second part is gene-set analysis, which tests whether genes within a defined gene-set is more associated with the pheotype than those outside of the set.</p>
For each gene <span class="math inline">\(g\)</span>, we obtain the gene p-value <span class="math inline">\(p_g\)</span> from part one of gene analysis. Next, for the part two of gene-set analysis, we first transform the p-values <span class="math inline">\(p_g\)</span> to Z-value using:
<center>
<span class="math inline">\(z_g=\Phi^{-1}(1-p_g)\)</span>, where <span class="math inline">\(\Phi^{-1}\)</span> is the probit function
</center>
<p>For gene set analysis, we test whether genes exhibit a stronger association with the phenotype of interest compared to other genes within a specific gene-set <span class="math inline">\(s\)</span> :</p>
<center>
<span class="math inline">\(Z = \beta_{0s} + S_s\beta_s + \epsilon\)</span>
</center>
<p><span class="math inline">\(\beta_{0s}\)</span>: intercept<br />
<span class="math inline">\(S_s:\)</span> An indicator variable, with <span class="math inline">\(S_g=1\)</span> for gene <span class="math inline">\(g\)</span> in the gene set <span class="math inline">\(s\)</span>.<br />
<span class="math inline">\(\beta_s\)</span>: effect of genes inside the gene sets compared to genes outside the region<br />
<span class="math inline">\(\epsilon\)</span>: residual</p>
<p>Then, MAGMA uses a t-test to test whether genes inside the test is more associated with the phenotype <span class="math inline">\(\beta_s&gt;0\)</span>, against null <span class="math inline">\(\beta_s=0\)</span>.</p>
<p>The MAGMA program can be downloaded from <a href="https://cncr.nl/research/magma/">MAGMA website</a> and can be installed under multiple systems. You can check their manual <a href="https://vu.data.surfsara.nl/index.php/s/MUiv3y1SFRePnyG">HERE</a>.</p>
<p>Additionally, their website also provides a list of public GWAS summary statistics data for you to download and practice. Please check them <a href="https://ctg.cncr.nl/software/summary_statistics">HERE</a>.</p>
<p>The MAGMA installation packages are already downloaded inside <code>Tools/MAGMA</code>.</p>
<div id="prepare-annotation-file" class="section level3 hasAnchor" number="8.2.1">
<h3><span class="header-section-number">8.2.1</span> Prepare Annotation File<a href="ldsc-and-gene-set-analysis.html#prepare-annotation-file" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Before we can run gene analysis, we need to map SNPs to genes based on their physical locations.</p>
<p>First set the working directory:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb1-1"><a href="ldsc-and-gene-set-analysis.html#cb1-1" tabindex="-1"></a><span class="co"># change the path below to where you saved &quot;cshl_gwas&quot; folder</span></span>
<span id="cb1-2"><a href="ldsc-and-gene-set-analysis.html#cb1-2" tabindex="-1"></a><span class="co">## run in R Terminal</span></span>
<span id="cb1-3"><a href="ldsc-and-gene-set-analysis.html#cb1-3" tabindex="-1"></a><span class="va">mydir</span><span class="op">=</span><span class="st">&quot;/path/to/cshl_gwas/Data/magma&quot;</span></span>
<span id="cb1-4"><a href="ldsc-and-gene-set-analysis.html#cb1-4" tabindex="-1"></a><span class="bu">cd</span> <span class="va">$mydir</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="ldsc-and-gene-set-analysis.html#cb2-1" tabindex="-1"></a><span class="co"># R codes- run in R Console</span></span>
<span id="cb2-2"><a href="ldsc-and-gene-set-analysis.html#cb2-2" tabindex="-1"></a><span class="fu">setwd</span>(<span class="st">&quot;/path/to/cshl_gwas/Data/magma&quot;</span>)</span>
<span id="cb2-3"><a href="ldsc-and-gene-set-analysis.html#cb2-3" tabindex="-1"></a>mydir<span class="ot">&lt;-</span><span class="fu">getwd</span>()</span></code></pre></div>
<p>MAGMA directly runs on PLINK binary format files, which is not human readable. We had <code>.ped</code> and <code>.map</code> files from PLINK, which is a text-based format and can be read by us. Let’s convert these text-based files to binary format file set <code>.bed</code>, <code>.bim</code> and <code>.fam</code> using PLINK.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb3-1"><a href="ldsc-and-gene-set-analysis.html#cb3-1" tabindex="-1"></a><span class="co">## # both Mac and Windows can run in Terminal</span></span>
<span id="cb3-2"><a href="ldsc-and-gene-set-analysis.html#cb3-2" tabindex="-1"></a><span class="co"># windows users</span></span>
<span id="cb3-3"><a href="ldsc-and-gene-set-analysis.html#cb3-3" tabindex="-1"></a><span class="ex">../../Tools/PLINK/plink_win64_20231211/plink.exe</span> <span class="dt">\</span></span>
<span id="cb3-4"><a href="ldsc-and-gene-set-analysis.html#cb3-4" tabindex="-1"></a>--noweb <span class="at">--file</span> ../case_data/genotype_1k <span class="at">--out</span> genotype_1k</span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb4-1"><a href="ldsc-and-gene-set-analysis.html#cb4-1" tabindex="-1"></a><span class="co"># macOS users</span></span>
<span id="cb4-2"><a href="ldsc-and-gene-set-analysis.html#cb4-2" tabindex="-1"></a><span class="ex">../../Tools/PLINK/plink_mac_20231211/plink</span> <span class="dt">\</span></span>
<span id="cb4-3"><a href="ldsc-and-gene-set-analysis.html#cb4-3" tabindex="-1"></a>--noweb <span class="at">--file</span> ../case_data/genotype_1k <span class="at">--out</span> genotype_1k</span></code></pre></div>
<pre><code>## PLINK v1.90b7.2 64-bit (11 Dec 2023)           www.cog-genomics.org/plink/1.9/
## (C) 2005-2023 Shaun Purcell, Christopher Chang   GNU General Public License v3
## Logging to genotype_1k.log.
## Options in effect:
##   --file ../case_data/genotype_1k
##   --noweb
##   --out genotype_1k
## 
## Note: --noweb has no effect since no web check is implemented yet.
## 16384 MB RAM detected; reserving 8192 MB for main workspace.
## Scanning .ped file... 0%1%1%2%2%3%3%4%4%5%5%6%6%7%7%8%8%9%9%10%10%11%11%12%13%13%14%14%15%15%16%16%17%17%18%18%19%19%20%20%21%21%22%22%23%23%24%24%25%26%26%27%27%28%28%29%29%30%30%31%31%32%32%33%33%34%34%35%35%36%36%37%38%38%39%39%40%40%41%41%42%42%43%43%44%44%45%45%46%46%47%47%48%48%49%49%50%51%51%52%52%53%53%54%54%55%55%56%56%57%57%58%58%59%59%60%60%61%61%62%63%63%64%64%65%65%66%66%67%67%68%68%69%69%70%70%71%71%72%72%73%73%74%74%75%76%76%77%77%78%78%79%79%80%80%81%81%82%82%83%83%84%84%85%85%86%86%87%88%88%89%89%90%90%91%91%92%92%93%93%94%94%95%95%96%96%97%97%98%98%99%100%.ped scan complete (for binary autoconversion).
## Performing single-pass .bed write (1000 variants, 192 people).
## 0%1%2%3%4%5%6%7%8%9%10%11%12%13%14%15%16%17%18%19%20%21%22%23%24%25%26%27%28%29%30%31%32%33%34%35%36%37%38%39%40%41%42%43%44%45%46%47%48%49%50%51%52%53%54%55%56%57%58%59%60%61%62%63%64%65%66%67%68%69%70%71%72%73%74%75%76%77%78%79%80%81%82%83%84%85%86%87%88%89%90%91%92%93%94%--file: genotype_1k.bed + genotype_1k.bim + genotype_1k.fam written.</code></pre>
<p>Before we run the MAGMA for gene level analysis, we have to create a annotation file that map the SNPs to gene. <code>MAGMA</code> directly handles this step with <code>--annotate</code>. The input files are two location files, one for SNP location and one for gene location. The output file is a file with extension <code>.annot</code> that contains one-to-one mapping of genes and SNPs.</p>
<p>By default, the <code>--annotate</code> doesn’t extend the gene region. But if we want to use all SNPs within a gene’s regulation region, we can specify the extending window using <code>--annotate window</code>. For example, <code>--annotate window=20,10</code> set a 20 kilobase pair(kb) upstream and 10kb downstream window.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb6-1"><a href="ldsc-and-gene-set-analysis.html#cb6-1" tabindex="-1"></a><span class="co">## both Mac and Windows can run in Terminal</span></span>
<span id="cb6-2"><a href="ldsc-and-gene-set-analysis.html#cb6-2" tabindex="-1"></a><span class="co"># windows users</span></span>
<span id="cb6-3"><a href="ldsc-and-gene-set-analysis.html#cb6-3" tabindex="-1"></a><span class="ex">../../Tools/MAGMA/magma_windows/magma</span> <span class="at">--annotate</span> <span class="at">--snp-loc</span> genotype_1k.bim <span class="dt">\</span></span>
<span id="cb6-4"><a href="ldsc-and-gene-set-analysis.html#cb6-4" tabindex="-1"></a>        <span class="at">--gene-loc</span> NCBI37.3.gene.loc <span class="dt">\</span></span>
<span id="cb6-5"><a href="ldsc-and-gene-set-analysis.html#cb6-5" tabindex="-1"></a>        <span class="at">--out</span> genotype_1k</span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb7-1"><a href="ldsc-and-gene-set-analysis.html#cb7-1" tabindex="-1"></a><span class="co"># mac users</span></span>
<span id="cb7-2"><a href="ldsc-and-gene-set-analysis.html#cb7-2" tabindex="-1"></a><span class="ex">../../Tools/MAGMA/magma_v1.10_mac/magma</span> <span class="at">--annotate</span> <span class="at">--snp-loc</span> genotype_1k.bim <span class="dt">\</span></span>
<span id="cb7-3"><a href="ldsc-and-gene-set-analysis.html#cb7-3" tabindex="-1"></a>        <span class="at">--gene-loc</span> NCBI37.3.gene.loc <span class="dt">\</span></span>
<span id="cb7-4"><a href="ldsc-and-gene-set-analysis.html#cb7-4" tabindex="-1"></a>        <span class="at">--out</span> genotype_1k</span></code></pre></div>
<pre><code>## Welcome to MAGMA v1.10 (custom)
## Using flags:
##  --annotate
##  --snp-loc genotype_1k.bim
##  --gene-loc NCBI37.3.gene.loc
##  --out genotype_1k
## 
## Start time is 00:30:00, Monday 09 Jun 2025
## 
## Starting annotation...
## Reading gene locations from file NCBI37.3.gene.loc... 
##  19427 gene locations read from file
##  chromosome  1: 2016 genes
##  chromosome  2: 1226 genes
##  chromosome  3: 1050 genes
##  chromosome  4: 745 genes
##  chromosome  5: 856 genes
##  chromosome  6: 1016 genes
##  chromosome  7: 906 genes
##  chromosome  8: 669 genes
##  chromosome  9: 775 genes
##  chromosome 10: 723 genes
##  chromosome 11: 1275 genes
##  chromosome 12: 1009 genes
##  chromosome 13: 320 genes
##  chromosome 14: 595 genes
##  chromosome 15: 586 genes
##  chromosome 16: 817 genes
##  chromosome 17: 1147 genes
##  chromosome 18: 271 genes
##  chromosome 19: 1389 genes
##  chromosome 20: 527 genes
##  chromosome 21: 215 genes
##  chromosome 22: 442 genes
##  chromosome  X: 805 genes
##  chromosome  Y: 47 genes
## Reading SNP locations from file genotype_1k.bim... 
##                                                                                                      984 SNP locations read from file
##  of those, 706 (71.75%) mapped to at least one gene
## Writing annotation to file genotype_1k.genes.annot
##  for chromosome  1, 1960 genes are empty (out of 2016)
##  for chromosome  2, 1184 genes are empty (out of 1226)
##  for chromosome  3, 1023 genes are empty (out of 1050)
##  for chromosome  4, 717 genes are empty (out of 745)
##  for chromosome  5, 825 genes are empty (out of 856)
##  for chromosome  6, 951 genes are empty (out of 1016)
##  for chromosome  7, 869 genes are empty (out of 906)
##  for chromosome  8, 651 genes are empty (out of 669)
##  for chromosome  9, 757 genes are empty (out of 775)
##  for chromosome 10, 692 genes are empty (out of 723)
##  for chromosome 11, 1243 genes are empty (out of 1275)
##  for chromosome 12, 982 genes are empty (out of 1009)
##  for chromosome 13, 312 genes are empty (out of 320)
##  for chromosome 14, 586 genes are empty (out of 595)
##  for chromosome 15, 577 genes are empty (out of 586)
##  for chromosome 16, 798 genes are empty (out of 817)
##  for chromosome 17, 1131 genes are empty (out of 1147)
##  for chromosome 18, 264 genes are empty (out of 271)
##  for chromosome 19, 1365 genes are empty (out of 1389)
##  for chromosome 20, 516 genes are empty (out of 527)
##  for chromosome 21, 209 genes are empty (out of 215)
##  for chromosome 22, 421 genes are empty (out of 442)
##  for chromosome  X, 794 genes are empty (out of 805)
##  for chromosome  Y, 45 genes are empty (out of 47)
##  at least one SNP mapped to each of a total of 555 genes (out of 19427)
## 
## 
## End time is 00:30:00, Monday 09 Jun 2025 (elapsed: 00:00:00)</code></pre>
</div>
<div id="part-1-gene-analysis" class="section level3 hasAnchor" number="8.2.2">
<h3><span class="header-section-number">8.2.2</span> Part 1: Gene Analysis<a href="ldsc-and-gene-set-analysis.html#part-1-gene-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>With the mapping file between SNPs and genes, we can perform the part one of gene analysis. We have the raw genotype data, therefore we can submit the input files for genotype binary files in <code>--bfile</code> and phenotype file in <code>--pheno</code> in the codes below.</p>
<p>If we only have p-values from GWAS results, we need to add a <code>--pval</code> option specifying a file containing SNPs p-values. Then the genotype data specified by <code>--bfile</code> will be the reference data used
to estimate LD between SNPs.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb9-1"><a href="ldsc-and-gene-set-analysis.html#cb9-1" tabindex="-1"></a><span class="co">## both Mac and Windows can run in Terminal</span></span>
<span id="cb9-2"><a href="ldsc-and-gene-set-analysis.html#cb9-2" tabindex="-1"></a><span class="co"># windows users</span></span>
<span id="cb9-3"><a href="ldsc-and-gene-set-analysis.html#cb9-3" tabindex="-1"></a><span class="ex">../../Tools/MAGMA/magma_windows/magma</span> <span class="at">--bfile</span> genotype_1k <span class="dt">\</span></span>
<span id="cb9-4"><a href="ldsc-and-gene-set-analysis.html#cb9-4" tabindex="-1"></a>        <span class="at">--pheno</span> file=phenotype_plink.txt <span class="dt">\</span></span>
<span id="cb9-5"><a href="ldsc-and-gene-set-analysis.html#cb9-5" tabindex="-1"></a>        <span class="at">--gene-annot</span> genotype_1k.genes.annot <span class="dt">\</span></span>
<span id="cb9-6"><a href="ldsc-and-gene-set-analysis.html#cb9-6" tabindex="-1"></a>        <span class="at">--out</span> younameit</span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb10-1"><a href="ldsc-and-gene-set-analysis.html#cb10-1" tabindex="-1"></a><span class="co"># mac users</span></span>
<span id="cb10-2"><a href="ldsc-and-gene-set-analysis.html#cb10-2" tabindex="-1"></a><span class="ex">../../Tools/MAGMA/magma_v1.10_mac/magma</span> <span class="at">--bfile</span> genotype_1k <span class="dt">\</span></span>
<span id="cb10-3"><a href="ldsc-and-gene-set-analysis.html#cb10-3" tabindex="-1"></a>        <span class="at">--pheno</span> file=phenotype_plink.txt <span class="dt">\</span></span>
<span id="cb10-4"><a href="ldsc-and-gene-set-analysis.html#cb10-4" tabindex="-1"></a>        <span class="at">--gene-annot</span> genotype_1k.genes.annot <span class="dt">\</span></span>
<span id="cb10-5"><a href="ldsc-and-gene-set-analysis.html#cb10-5" tabindex="-1"></a>        <span class="at">--out</span> younameit</span></code></pre></div>
<p>The output file is ended with <code>.genes.out</code>.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb11-1"><a href="ldsc-and-gene-set-analysis.html#cb11-1" tabindex="-1"></a><span class="fu">head</span> younameit.genes.out</span></code></pre></div>
<pre><code>## GENE       CHR      START       STOP  NSNPS  NPARAM    N        ZSTAT            P          RSQ      RSQ_ADJ
## 55187        1   12290101   12572099      1       1  192       1.8896     0.029407     0.024721     0.019588
## 90529        1   24683489   24741587      1       1  192      0.10656      0.45757    0.0029078            0
## 23585        1   25664789   25688852      1       1  192      -1.2108      0.88702   0.00010651            0
## 8431         1   27237975   27240567      1       1  192      -1.2979      0.90285   7.8625e-05            0
## 199870       1   28052490   28089426      1       1  192     -0.04252      0.51696    0.0022137            0
## 1441         1   36931644   36948915      1       1  192     -0.69858      0.75759   0.00050257            0
## 3633         1   38326369   38412729      1       1  192      -1.6444      0.94995   2.0792e-05            0
## 23499        1   39549839   39952810      1       1  192    -0.067989       0.5271    0.0021084            0
## 54802        1   40306703   40349177      1       1  192        1.286     0.099225      0.01424    0.0090521</code></pre>
<p>we can also generate manhattan plots to compare the SNP-wise results and gene-based results.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="ldsc-and-gene-set-analysis.html#cb13-1" tabindex="-1"></a><span class="fu">library</span>(data.table)</span>
<span id="cb13-2"><a href="ldsc-and-gene-set-analysis.html#cb13-2" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb13-3"><a href="ldsc-and-gene-set-analysis.html#cb13-3" tabindex="-1"></a>magma_result <span class="ot">&lt;-</span> <span class="fu">fread</span>(<span class="st">&quot;younameit.genes.out&quot;</span>)</span>
<span id="cb13-4"><a href="ldsc-and-gene-set-analysis.html#cb13-4" tabindex="-1"></a>annotate <span class="ot">&lt;-</span> <span class="fu">fread</span>(<span class="st">&quot;NCBI37.3.gene.loc&quot;</span>)</span>
<span id="cb13-5"><a href="ldsc-and-gene-set-analysis.html#cb13-5" tabindex="-1"></a><span class="co"># replace gene index with gene name </span></span>
<span id="cb13-6"><a href="ldsc-and-gene-set-analysis.html#cb13-6" tabindex="-1"></a>magma_result[, <span class="dv">1</span>] <span class="ot">&lt;-</span> annotate[<span class="fu">match</span>(<span class="fu">as.matrix</span>(magma_result[, <span class="dv">1</span>]), <span class="fu">as.matrix</span>(annotate[, <span class="dv">1</span>])), <span class="dv">6</span>]</span>
<span id="cb13-7"><a href="ldsc-and-gene-set-analysis.html#cb13-7" tabindex="-1"></a><span class="co"># show some of the result</span></span>
<span id="cb13-8"><a href="ldsc-and-gene-set-analysis.html#cb13-8" tabindex="-1"></a><span class="fu">head</span>(magma_result)</span></code></pre></div>
<pre><code>##       GENE   CHR    START     STOP NSNPS NPARAM     N    ZSTAT        P
##     &lt;char&gt; &lt;int&gt;    &lt;int&gt;    &lt;int&gt; &lt;int&gt;  &lt;int&gt; &lt;int&gt;    &lt;num&gt;    &lt;num&gt;
## 1:  VPS13D     1 12290101 12572099     1      1   192  1.88960 0.029407
## 2:   STPG1     1 24683489 24741587     1      1   192  0.10656 0.457570
## 3: TMEM50A     1 25664789 25688852     1      1   192 -1.21080 0.887020
## 4:   NR0B2     1 27237975 27240567     1      1   192 -1.29790 0.902850
## 5:  FAM76A     1 28052490 28089426     1      1   192 -0.04252 0.516960
## 6:   CSF3R     1 36931644 36948915     1      1   192 -0.69858 0.757590
##           RSQ  RSQ_ADJ
##         &lt;num&gt;    &lt;num&gt;
## 1: 2.4721e-02 0.019588
## 2: 2.9078e-03 0.000000
## 3: 1.0651e-04 0.000000
## 4: 7.8625e-05 0.000000
## 5: 2.2137e-03 0.000000
## 6: 5.0257e-04 0.000000</code></pre>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="ldsc-and-gene-set-analysis.html#cb15-1" tabindex="-1"></a><span class="co"># resummarize for manhattan plot </span></span>
<span id="cb15-2"><a href="ldsc-and-gene-set-analysis.html#cb15-2" tabindex="-1"></a>qassoc <span class="ot">=</span> <span class="fu">cbind</span>(magma_result<span class="sc">$</span>CHR, magma_result<span class="sc">$</span>GENE, (magma_result<span class="sc">$</span>START<span class="sc">+</span>magma_result<span class="sc">$</span>STOP)<span class="sc">/</span><span class="dv">2</span>, magma_result<span class="sc">$</span>P)</span>
<span id="cb15-3"><a href="ldsc-and-gene-set-analysis.html#cb15-3" tabindex="-1"></a><span class="fu">colnames</span>(qassoc) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;CHR&quot;</span>,<span class="st">&quot;SNP&quot;</span>, <span class="st">&quot;BP&quot;</span>, <span class="st">&quot;P&quot;</span>)</span>
<span id="cb15-4"><a href="ldsc-and-gene-set-analysis.html#cb15-4" tabindex="-1"></a>qassoc <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(qassoc)</span>
<span id="cb15-5"><a href="ldsc-and-gene-set-analysis.html#cb15-5" tabindex="-1"></a>qassoc<span class="sc">$</span>CHR <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(qassoc<span class="sc">$</span>CHR)</span>
<span id="cb15-6"><a href="ldsc-and-gene-set-analysis.html#cb15-6" tabindex="-1"></a>qassoc<span class="sc">$</span>BP <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(qassoc<span class="sc">$</span>BP)</span>
<span id="cb15-7"><a href="ldsc-and-gene-set-analysis.html#cb15-7" tabindex="-1"></a>qassoc<span class="sc">$</span>P <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(qassoc<span class="sc">$</span>P)</span>
<span id="cb15-8"><a href="ldsc-and-gene-set-analysis.html#cb15-8" tabindex="-1"></a>qassoc <span class="ot">&lt;-</span> qassoc <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(P)</span>
<span id="cb15-9"><a href="ldsc-and-gene-set-analysis.html#cb15-9" tabindex="-1"></a><span class="fu">head</span>(qassoc)</span></code></pre></div>
<pre><code>##   CHR     SNP        BP          P
## 1  22   TCF20  42610394 0.00016134
## 2   3 ATP13A5 193044672 0.00020216
## 3  22  NDUFA6  42484209 0.00034808
## 4  22    RAC2  37630820 0.00067431
## 5  22  WBP2NL  42410271 0.00069317
## 6  22   SEPT3  42383540 0.00077054</code></pre>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="ldsc-and-gene-set-analysis.html#cb17-1" tabindex="-1"></a><span class="fu">png</span>(<span class="at">filename=</span><span class="fu">paste0</span>(<span class="st">&quot;Manhattan_Plot_for_magma.png&quot;</span>))</span>
<span id="cb17-2"><a href="ldsc-and-gene-set-analysis.html#cb17-2" tabindex="-1"></a><span class="fu">manhattan</span>(qassoc, <span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;dimgray&quot;</span>, <span class="st">&quot;darkgoldenrod1&quot;</span>), <span class="at">suggestiveline=</span>T, <span class="at">genomewideline=</span>F, <span class="at">annotatePval=</span><span class="fl">0.001</span>)</span>
<span id="cb17-3"><a href="ldsc-and-gene-set-analysis.html#cb17-3" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code></pre></div>
<pre><code>## quartz_off_screen 
##                 2</code></pre>
<p>We can load the plot from MAGMA for gene-based results:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="ldsc-and-gene-set-analysis.html#cb19-1" tabindex="-1"></a>img <span class="ot">&lt;-</span> <span class="fu">readPNG</span>(<span class="st">&quot;Manhattan_Plot_for_magma.png&quot;</span>)</span>
<span id="cb19-2"><a href="ldsc-and-gene-set-analysis.html#cb19-2" tabindex="-1"></a>grid<span class="sc">::</span><span class="fu">grid.raster</span>(img)</span></code></pre></div>
<p><img src="cshl_gwas_files/figure-html/magma1-1.png" width="672" /></p>
<p>This is the previous plot for SNP-based results:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="ldsc-and-gene-set-analysis.html#cb20-1" tabindex="-1"></a>img <span class="ot">&lt;-</span> <span class="fu">readPNG</span>(<span class="st">&quot;../case_data/Manhattan_Plot_for_z-4-oh-Tam.png&quot;</span>)</span>
<span id="cb20-2"><a href="ldsc-and-gene-set-analysis.html#cb20-2" tabindex="-1"></a>grid<span class="sc">::</span><span class="fu">grid.raster</span>(img)</span></code></pre></div>
<p><img src="cshl_gwas_files/figure-html/oldmah-1.png" width="672" /></p>
</div>
<div id="part-2-gene-set-analysis" class="section level3 hasAnchor" number="8.2.3">
<h3><span class="header-section-number">8.2.3</span> Part 2: Gene-Set Analysis<a href="ldsc-and-gene-set-analysis.html#part-2-gene-set-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>For gene-set analysis, we first need to prepare a geneset file that defines the set. The first column is the geneset name, followed by gene IDs in the set that matches IDs in the output file <code>*.genes.out</code> from the last step. The manhattan plot shows a strong signal in chromosome 22, so we set the gene set to be all genes in chromosome 22 and test whether they are more closely associated with phenotype than other genes. An example of the gene set file looks like this:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb21-1"><a href="ldsc-and-gene-set-analysis.html#cb21-1" tabindex="-1"></a><span class="fu">head</span> gene_set.txt</span></code></pre></div>
<pre><code>## Chr22    23523   114904  5880    2033    150356  7008    50  5372    150365  79879   6721    440829  79019   55964   164684  4668    4700    6942    23313   5465</code></pre>
<p>The input files to MAGMA includes a binary output file from the last step <code>*.genes.raw</code>, which is not human-readable, and the above gene set file we defined. The output files ended with <code>*gsa.genes.out</code> which contains results from the test.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb23-1"><a href="ldsc-and-gene-set-analysis.html#cb23-1" tabindex="-1"></a><span class="co">## both Mac and Windows can run in Terminal</span></span>
<span id="cb23-2"><a href="ldsc-and-gene-set-analysis.html#cb23-2" tabindex="-1"></a><span class="co"># windows users</span></span>
<span id="cb23-3"><a href="ldsc-and-gene-set-analysis.html#cb23-3" tabindex="-1"></a><span class="va">geneset</span><span class="op">=</span>gene_set.txt</span>
<span id="cb23-4"><a href="ldsc-and-gene-set-analysis.html#cb23-4" tabindex="-1"></a><span class="ex">../../Tools/MAGMA/magma_windows/magma</span> <span class="dt">\</span></span>
<span id="cb23-5"><a href="ldsc-and-gene-set-analysis.html#cb23-5" tabindex="-1"></a>    <span class="at">--gene-results</span> younameit.genes.raw <span class="dt">\</span></span>
<span id="cb23-6"><a href="ldsc-and-gene-set-analysis.html#cb23-6" tabindex="-1"></a>    <span class="at">--set-annot</span> <span class="va">${geneset}</span> <span class="dt">\</span></span>
<span id="cb23-7"><a href="ldsc-and-gene-set-analysis.html#cb23-7" tabindex="-1"></a>    <span class="at">--out</span> younameit</span></code></pre></div>
<div class="sourceCode" id="cb24"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb24-1"><a href="ldsc-and-gene-set-analysis.html#cb24-1" tabindex="-1"></a><span class="co"># mac users</span></span>
<span id="cb24-2"><a href="ldsc-and-gene-set-analysis.html#cb24-2" tabindex="-1"></a><span class="va">geneset</span><span class="op">=</span>gene_set.txt</span>
<span id="cb24-3"><a href="ldsc-and-gene-set-analysis.html#cb24-3" tabindex="-1"></a><span class="ex">../../Tools/MAGMA/magma_v1.10_mac/magma</span> <span class="dt">\</span></span>
<span id="cb24-4"><a href="ldsc-and-gene-set-analysis.html#cb24-4" tabindex="-1"></a>    <span class="at">--gene-results</span> younameit.genes.raw <span class="dt">\</span></span>
<span id="cb24-5"><a href="ldsc-and-gene-set-analysis.html#cb24-5" tabindex="-1"></a>    <span class="at">--set-annot</span> <span class="va">${geneset}</span> <span class="dt">\</span></span>
<span id="cb24-6"><a href="ldsc-and-gene-set-analysis.html#cb24-6" tabindex="-1"></a>    <span class="at">--out</span> younameit</span></code></pre></div>
<pre><code>## Welcome to MAGMA v1.10 (custom)
## Using flags:
##  --gene-results younameit.genes.raw
##  --set-annot gene_set.txt
##  --out younameit
## 
## Start time is 00:30:00, Monday 09 Jun 2025
## 
## Reading file younameit.genes.raw... 
##  451 genes read from file
## Loading gene-set annotation...
## Reading file gene_set.txt... 
##  1 gene-set definition read from file
##  found 1 gene set containing genes defined in genotype data (containing a total of 20 unique genes)
## Preparing variables for analysis...
##  truncating Z-scores 3 points below zero or 6 standard deviations above the mean
##  truncating covariate values more than 5 standard deviations from the mean
##  total variables available for analysis: 1 gene set
## 
## Parsing model specifications...
## Inverting gene-gene correlation matrix...
##  processing block 1 of 135   processing block 2 of 135   processing block 3 of 135   processing block 4 of 135   processing block 5 of 135   processing block 6 of 135   processing block 7 of 135   processing block 8 of 135   processing block 9 of 135   processing block 10 of 135  processing block 11 of 135  processing block 12 of 135  processing block 13 of 135  processing block 14 of 135  processing block 15 of 135  processing block 16 of 135  processing block 17 of 135  processing block 18 of 135  processing block 19 of 135  processing block 20 of 135  processing block 21 of 135  processing block 22 of 135  processing block 23 of 135  processing block 24 of 135  processing block 25 of 135  processing block 26 of 135  processing block 27 of 135  processing block 28 of 135  processing block 29 of 135  processing block 30 of 135  processing block 31 of 135  processing block 32 of 135  processing block 33 of 135  processing block 34 of 135  processing block 35 of 135  processing block 36 of 135  processing block 37 of 135  processing block 38 of 135  processing block 39 of 135  processing block 40 of 135  processing block 41 of 135  processing block 42 of 135  processing block 43 of 135  processing block 44 of 135  processing block 45 of 135  processing block 46 of 135  processing block 47 of 135  processing block 48 of 135  processing block 49 of 135  processing block 50 of 135  processing block 51 of 135  processing block 52 of 135  processing block 53 of 135  processing block 54 of 135  processing block 55 of 135  processing block 56 of 135  processing block 57 of 135  processing block 58 of 135  processing block 59 of 135  processing block 60 of 135  processing block 61 of 135  processing block 62 of 135  processing block 63 of 135  processing block 64 of 135  processing block 65 of 135  processing block 66 of 135  processing block 67 of 135  processing block 68 of 135  processing block 69 of 135  processing block 70 of 135  processing block 71 of 135  processing block 72 of 135  processing block 73 of 135  processing block 74 of 135  processing block 75 of 135  processing block 76 of 135  processing block 77 of 135  processing block 78 of 135  processing block 79 of 135  processing block 80 of 135  processing block 81 of 135  processing block 82 of 135  processing block 83 of 135  processing block 84 of 135  processing block 85 of 135  processing block 86 of 135  processing block 87 of 135  processing block 88 of 135  processing block 89 of 135  processing block 90 of 135  processing block 91 of 135  processing block 92 of 135  processing block 93 of 135  processing block 94 of 135  processing block 95 of 135  processing block 96 of 135  processing block 97 of 135  processing block 98 of 135  processing block 99 of 135  processing block 100 of 135 processing block 101 of 135 processing block 102 of 135 processing block 103 of 135 processing block 104 of 135 processing block 105 of 135 processing block 106 of 135 processing block 107 of 135 processing block 108 of 135 processing block 109 of 135 processing block 110 of 135 processing block 111 of 135 processing block 112 of 135 processing block 113 of 135 processing block 114 of 135 processing block 115 of 135 processing block 116 of 135 processing block 117 of 135 processing block 118 of 135 processing block 119 of 135 processing block 120 of 135 processing block 121 of 135 processing block 122 of 135 processing block 123 of 135 processing block 124 of 135 processing block 125 of 135 processing block 126 of 135 processing block 127 of 135 processing block 128 of 135 processing block 129 of 135 processing block 130 of 135 processing block 131 of 135 processing block 132 of 135 processing block 133 of 135 processing block 134 of 135 processing block 135 of 135                                                                                                                   Performing regression analysis...
##  testing direction: one-sided, positive (sets), two-sided (covar)
##  conditioning on internal variables:
##      gene size, log(gene size)
##      gene density, log(gene density)
##      inverse mac, log(inverse mac)
##  analysing individual variables
## 
##  analysing single-variable models (number of models: 1)
##                                                                                                                      writing results to file younameit.gsa.out
##  writing gene information to file younameit.gsa.genes.out
##  writing gene analysis results per significant result (after multiple testing correction, at alpha = 0.05) to file younameit.gsa.sets.genes.out
## 
## End time is 00:30:00, Monday 09 Jun 2025 (elapsed: 00:00:00)</code></pre>
<div class="sourceCode" id="cb26"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb26-1"><a href="ldsc-and-gene-set-analysis.html#cb26-1" tabindex="-1"></a><span class="fu">head</span> younameit.gsa.out</span></code></pre></div>
<pre><code>## # MEAN_SAMPLE_SIZE = 192
## # TOTAL_GENES = 451
## # TEST_DIRECTION = one-sided, positive (set), two-sided (covar)
## # CONDITIONED_INTERNAL = gene size, gene density, inverse mac, log(gene size), log(gene density), log(inverse mac)
## VARIABLE      TYPE  NGENES         BETA     BETA_STD           SE            P
## Chr22          SET      20        1.202      0.24772      0.33072   0.00015625</code></pre>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="gxg-and-gxe-interactions-power-and-sample-size-calculation.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="perform-eqtl-analysis.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/07-post_GWAS.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["cshl_gwas.pdf", "cshl_gwas.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
